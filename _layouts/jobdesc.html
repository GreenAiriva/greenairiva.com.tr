<!DOCTYPE html>
<html lang="{{ page.lang | default: 'en' }}">
  {% include head.html %}
  <body id="page-top">
    {% if page.lang == "tr" %}
      {% include header_tr.html %}
    {% else %}
      {% include header.html %}
    {% endif %}

    {{ content }}

    {% if page.lang == "tr" %}
      {% include footer_tr.html %}
    {% else %}
      {% include footer.html %}
    {% endif %}

    <!-- Universal Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://kit.fontawesome.com/yourfontawesomekit.js" crossorigin="anonymous"></script>
    <script src="{{ site.baseurl }}/js/scripts.js"></script>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
      // 1. URL'den slug oku (?slug=chemical-engineer gibi)
      const params = new URLSearchParams(window.location.search);
      const slug = params.get('slug');
      if (!slug) return;

      // 2. jobs.json'dan ilgili işi bul
      fetch('{{ site.baseurl }}/career/jobs.json')
        .then(response => response.json())
        .then(jobs => {
          const job = jobs.find(j => j.slug === slug);
          if (!job) {
            const nf = document.getElementById('article-notfound');
            if (nf) nf.style.display = 'block';
            const single = document.querySelector('.job-single');
            if (single) single.style.display = 'none';
            return;
          }

          // 3. Başlık ve meta bilgilerini doldur
          const titleHead = document.getElementById('article-title-head');
          if (titleHead) titleHead.textContent = job.title || '';

          const locationHead = document.getElementById('article-location-head');
          if (locationHead) locationHead.textContent = job.location || '';

          const typeHead = document.getElementById('article-type-head');
          if (typeHead) typeHead.textContent = job.type || '';

          // 4. Markdown içeriğini çek ve göster
          if (job.url) {
            fetch('{{ site.baseurl }}' + job.url)
              .then(res => res.text())
              .then(md => {
                if (window.marked) {
                  document.getElementById('article-content').innerHTML = marked.parse(md);
                } else {
                  document.getElementById('article-content').textContent = md;
                }
              });
          }
        })
        .catch(err => console.error('Job detail load error:', err));
    });
    </script>

    <!-- Optional: Markdown desteği -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  </body>
</html>
