<!DOCTYPE html>
<html lang="{{ page.lang | default: 'en' }}">
  {% include head.html %}
  <body id="page-top">
    {% if page.lang == "tr" %}
      {% include header_tr.html %}
    {% else %}
      {% include header.html %}
    {% endif %}

    {{ content }}

    {% if page.lang == "tr" %}
      {% include footer_tr.html %}
    {% else %}
      {% include footer.html %}
    {% endif %}

    <!-- Universal Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://kit.fontawesome.com/yourfontawesomekit.js" crossorigin="anonymous"></script>
    <script src="{{ site.baseurl }}/js/scripts.js"></script>
	<script>
	document.addEventListener('DOMContentLoaded', function () {
	  // 1. URL'den slug/id oku (?slug=2025-07-14-sera-gazlari gibi)
	  const params = new URLSearchParams(window.location.search);
	  const slug = params.get('slug');

	  // 2. posts.json'dan ilgili yazıyı bul
	  fetch('posts.json')
	    .then(response => response.json())
	    .then(posts => {
	      const post = posts.find(p => p.slug === slug);
	      if (!post) {
	        document.getElementById('article-notfound').style.display = 'block';
	        document.querySelector('.blog-single').style.display = 'none';
   	     return;
	      }

    	  if (post.image) {
  	      document.getElementById('article-masthead').style.backgroundImage = `url('${post.image}')`;
        	document.getElementById('article-masthead').style.backgroundColor = "#212529";
      	}
        	 document.getElementById('article-category-head').textContent = post.category || '';
         	document.getElementById('article-title-head').textContent = post.title || '';
         	document.getElementById('article-date-head').textContent = post.date ? new Date(post.date).toLocaleDateString('tr-TR', { day: '2-digit', month: 'long', year: 'numeric' }) : '';

     
      // 3. Alanları doldur
//      if (post.image) {
//        const img = document.getElementById('article-image');
//        img.src = post.image;
//        img.alt = post.title;
//        img.style.display = 'block';
//      }
//      document.getElementById('article-category').textContent = post.category || '';
//      document.getElementById('article-date').textContent = post.date ? new Date(post.date).toLocaleDateString('tr-TR', { day: '2-digit', month: 'long', year: 'numeric' }) : '';
//      document.getElementById('article-title').textContent = post.title || '';
//      document.getElementById('article-summary').textContent = post.summary || '';
      // 4. İçerik dosyasını fetch et (ör: /posts/2025-07-14-sera-gazlari.md)
      if (post.url) {
        fetch(post.url)
          .then(res => res.text())
          .then(md => {
            // Eğer markdown ise marked.js ile parse et, yoksa direkt göster
            if (window.marked) {
              document.getElementById('article-content').innerHTML = marked.parse(md);
            } else {
              document.getElementById('article-content').textContent = md;
            }
          });
      }
    });
});
</script>
<!-- Optional: Markdown desteği için -->
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  </body>
</html>
